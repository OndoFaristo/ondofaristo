<?xml version="1.0" encoding="UTF-8"?>

<!--
This is a Studio Managed File.  Do not edit this file directly. Use security editor in studio only.
-->

<beans:beans xmlns="http://www.springframework.org/schema/security"
    xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans 
                    http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
                    http://www.springframework.org/schema/security 
                    http://www.springframework.org/schema/security/spring-security-3.1.xsd">
  <debug /> 

  <global-method-security pre-post-annotations="enabled" />
                    
  <http auto-config="false" use-expressions="true" >
    <custom-filter position="FORM_LOGIN_FILTER" ref="WMSecAuthFilter" /> 
	<http-basic entry-point-ref="WMSecAuthEntryPoint" />
<!-- Uncomment to access app without authentication  
	<intercept-url pattern="/**" access="permitAll" /> -->
	<intercept-url pattern="/app.css" access="permitAll" />
    <intercept-url pattern="/config.js" access="permitAll" />
    <intercept-url pattern="/types.js" access="permitAll" />
    <intercept-url pattern="/login.html" access="permitAll" />
    <intercept-url pattern="/pages/login/**" access="permitAll" />
    <intercept-url pattern="/securityservice.json" access="permitAll" />
    <intercept-url pattern="/j_spring_security_check" access="permitAll" />
    <intercept-url pattern="/*.upload" access="isAuthenticated()" />
    <intercept-url pattern="/*.download" access="isAuthenticated()" /> 
    <intercept-url pattern="/index.html" access="isAuthenticated()" /> 
    <intercept-url pattern="/" access="isAuthenticated()" /> 
    <intercept-url pattern="/pages/**" access="isAuthenticated()" /> 
    <intercept-url pattern="/*.json" access="isAuthenticated()" /> 
    <intercept-url pattern="/*/*.json" access="isAuthenticated()" /> 
    <intercept-url pattern="/**" access="isAuthenticated()" />
    <logout />
  </http>

<authentication-manager>
  <authentication-provider ref="myAuthenticationProvider" />
</authentication-manager>
  
<beans:bean id="WMSecAuthFilter" class="org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter">
	<beans:property name="authenticationSuccessHandler" ref="successHandler" />
	<beans:property name="authenticationManager" ref="authenticationManager" />
</beans:bean>

<beans:bean id="WMSecAuthEntryPoint"
  class="org.springframework.security.web.authentication.LoginUrlAuthenticationEntryPoint">
 <beans:property name="loginFormUrl" value="/login.html"/>
</beans:bean>	
	
<beans:bean id="successHandler" class="com.wavemaker.runtime.security.WMAuthenticationSuccessHandler"/>	   
              
    <!--
    Usernames/Passwords are
        admin/admin
        manager/manager
        user/user
    -->
 
    <authentication-manager alias="authenticationManager">
        <authentication-provider>
            <password-encoder hash="md5"/>
            <user-service>
                <user name="admin" password="21232f297a57a5a743894a0e4a801fc3" authorities="admin, manager,user" />
                <user name="manager" password="1d0258c2440a8d19e716292b231e3190" authorities="manager,user" />
                <user name="user" password="ee11cbb19052e40b07aac0ca060c23ee" authorities="user" />
            </user-service>
        </authentication-provider>
    </authentication-manager>

	<!--authentication-manager alias="authenticationManager">
		<authentication-provider user-service-ref = "jdbcUserService">
		</authentication-provider>
	</authentication-manager>

	<beans:bean id = "jdbcUserService"  class = "com.wavemaker.runtime.security.EnhancedJdbcDaoImpl">
		<beans:property name = "dataSource" ref = "mytestdbDataSource" />
		<beans:property name = "usersByUsernameQuery" value = "SELECT userid, password, 1, username FROM user WHERE username = ?" />
		<beans:property name = "authoritiesByUsernameQuery" value = "select u.userid, ur.role from user u, user_roles ur where u.id = ur.userid and u.userid =?" />
	</beans:bean-->
    
                          
</beans:beans> 
